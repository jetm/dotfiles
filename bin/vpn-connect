#!/bin/bash

set -e

action=${1}
case ${action} in
    connect)
        GATEWAY=global.remoteaccess.hp.com
        __USER=W21835802

        read -r -s -p "Please provide OATH PASS: " OATH_PASS

        pulsesvc -L 5 \
            -h "${GATEWAY}" \
            -u "${__USER}" \
            -p "${OATH_PASS}" \
            -r "OATH Passcode" &

        unset OATH_PASS
        unset __USER
        unset GATEWAY
        ;;

    disconnect)
        pulsesvc -K
        ;;

    *)
        echo 'Usage: vpn-connect [connect|disconnect]'
        exit 1
        ;;
esac

unset action
